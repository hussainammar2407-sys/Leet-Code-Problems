#include <stdio.h>

/**
 * @brief Finds the index of the target in a sorted array, or the index where it would be inserted.
 * * @param nums The sorted array of distinct integers.
 * @param numsSize The size of the array.
 * @param target The value to search for or insert.
 * @return The index where the target is found or should be inserted.
 */
int searchInsert(int* nums, int numsSize, int target) {
    // 1. Initialize pointers for the search range
    int low = 0;
    int high = numsSize - 1;
    
    // 2. Perform Binary Search
    while (low <= high) {
        // Calculate the middle index
        // Using low + (high - low) / 2 prevents potential integer overflow 
        // compared to (low + high) / 2, although less critical in C's int limits.
        int mid = low + (high - low) / 2;
        
        // Check if the target is found
        if (nums[mid] == target) {
            return mid; // Target found at this index
        } 
        // If the middle element is less than the target, 
        // the target must be in the right half (if it exists).
        else if (nums[mid] < target) {
            low = mid + 1; // Discard the left half, move 'low' to the right of 'mid'
        } 
        // If the middle element is greater than the target, 
        // the target must be in the left half (if it exists).
        else { // nums[mid] > target
            high = mid - 1; // Discard the right half, move 'high' to the left of 'mid'
        }
    }
    
    // 3. Handle the insertion case
    // If the loop terminates, the target was not found.
    // In Binary Search, 'low' will always point to the **correct insertion point**.
    // 'low' is the index of the first element GREATER THAN the target.
    // If all elements are less than the target, 'low' will be numsSize.
    return low;
}

/*
// Example Usage (for testing locally)
int main() {
    int nums1[] = {1, 3, 5, 6};
    int size1 = 4;
    int target1 = 5;
    printf("Target %d is at index: %d\n", target1, searchInsert(nums1, size1, target1)); // Output: 2

    int nums2[] = {1, 3, 5, 6};
    int size2 = 4;
    int target2 = 2;
    printf("Target %d should be inserted at index: %d\n", target2, searchInsert(nums2, size2, target2)); // Output: 1

    int nums3[] = {1, 3, 5, 6};
    int size3 = 4;
    int target3 = 7;
    printf("Target %d should be inserted at index: %d\n", target3, searchInsert(nums3, size3, target3)); // Output: 4
    
    int nums4[] = {1, 3, 5, 6};
    int size4 = 4;
    int target4 = 0;
    printf("Target %d should be inserted at index: %d\n", target4, searchInsert(nums4, size4, target4)); // Output: 0

    return 0;
}
*/
